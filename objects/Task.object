<?xml version="1.0" encoding="UTF-8"?>
<CustomObject xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionOverrides>
        <actionName>CancelEdit</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Close</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Delete</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>DeleteSeries</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Edit</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>NewTask</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>SaveEdit</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>View</actionName>
        <type>Default</type>
    </actionOverrides>
    <compactLayoutAssignment>SYSTEM</compactLayoutAssignment>
    <enableFeeds>false</enableFeeds>
    <fieldSets>
        <fullName>CRMC_PP__Batch_Add</fullName>
        <description>Batch Add</description>
        <displayedFields>
            <field>AccountId</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>OwnerId</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>Subject</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>ActivityDate</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>Status</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>Priority</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>Description</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <label>Batch Add</label>
    </fieldSets>
    <fieldSets>
        <fullName>Task_Fields_On_Lead_Conversion</fullName>
        <description>This will be used in custom lead conversion page for creating activity.</description>
        <displayedFields>
            <field>Subject</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>true</isRequired>
        </displayedFields>
        <displayedFields>
            <field>ActivityDate</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>Type</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>Priority</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>IsReminderSet</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>Description</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>ReminderDateTime</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <label>Task Fields On Lead Conversion</label>
    </fieldSets>
    <fieldSets>
        <fullName>activities__CreateTasks</fullName>
        <availableFields>
            <field>AccountId</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>Id</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>IsRecurrence</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>RecurrenceActivityId</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>RecurrenceDayOfMonth</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>RecurrenceDayOfWeekMask</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>RecurrenceInterval</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>RecurrenceMonthOfYear</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>RecurrenceRegeneratedType</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>WhatId</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>WhoId</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <description>CreateTasks</description>
        <displayedFields>
            <field>OwnerId</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>ActivityDate</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>Subject</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>Status</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>Type</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>Priority</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>Description</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <label>CreateTasks</label>
    </fieldSets>
    <fieldSets>
        <fullName>activities__MassUpdateTasks</fullName>
        <availableFields>
            <field>Description</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>IsReminderSet</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>OwnerId</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>Priority</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>Status</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>Subject</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>Type</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>WhatId</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <availableFields>
            <field>WhoId</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </availableFields>
        <description>UpdateTasks</description>
        <displayedFields>
            <field>ActivityDate</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>ReminderDateTime</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <displayedFields>
            <field>Updated_Status__c</field>
            <isFieldManaged>false</isFieldManaged>
            <isRequired>false</isRequired>
        </displayedFields>
        <label>MassUpdateTasks</label>
    </fieldSets>
    <fields>
        <fullName>ActivityDate</fullName>
    </fields>
    <fields>
        <fullName>CallDisposition</fullName>
    </fields>
    <fields>
        <fullName>CallDurationInSeconds</fullName>
    </fields>
    <fields>
        <fullName>CallObject</fullName>
    </fields>
    <fields>
        <fullName>CallType</fullName>
    </fields>
    <fields>
        <fullName>Description</fullName>
    </fields>
    <fields>
        <fullName>Email</fullName>
    </fields>
    <fields>
        <fullName>IsRecurrence</fullName>
    </fields>
    <fields>
        <fullName>IsReminderSet</fullName>
    </fields>
    <fields>
        <fullName>IsVisibleInSelfService</fullName>
    </fields>
    <fields>
        <fullName>OwnerId</fullName>
        <type>Lookup</type>
    </fields>
    <fields>
        <fullName>Phone</fullName>
    </fields>
    <fields>
        <fullName>Priority</fullName>
        <type>Picklist</type>
    </fields>
    <fields>
        <fullName>RecurrenceInterval</fullName>
    </fields>
    <fields>
        <fullName>RecurrenceRegeneratedType</fullName>
    </fields>
    <fields>
        <fullName>Status</fullName>
        <type>Picklist</type>
    </fields>
    <fields>
        <fullName>Subject</fullName>
        <type>Picklist</type>
    </fields>
    <fields>
        <fullName>TaskSubtype</fullName>
    </fields>
    <fields>
        <fullName>Type</fullName>
        <type>Picklist</type>
    </fields>
    <fields>
        <fullName>WhatId</fullName>
        <type>Lookup</type>
    </fields>
    <fields>
        <fullName>WhoId</fullName>
        <type>Lookup</type>
    </fields>
    <sharingModel>ControlledByParent</sharingModel>
    <validationRules>
        <fullName>Change_Status_for_Escalation_Task</fullName>
        <active>true</active>
        <description>Validation if user tries to change the task type from Escalation to anything else without clicking on Take Ownership button</description>
        <errorConditionFormula>AND (  ISCHANGED(Status), ISPICKVAL(Type, &quot;Escalation&quot;), ISPICKVAL(Status, &quot;Completed&quot;),NOT(ISBLANK(Case_Escalated_To_Value__c)))</errorConditionFormula>
        <errorMessage>Click Cancel then Click Take Ownership of the Task before making edits</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>Change_type_for_Escalation_Task</fullName>
        <active>true</active>
        <description>Validation if user tries to change the task type from Escalation to anything else without clicking on Take Ownership button</description>
        <errorConditionFormula>AND ( NOT(ISNEW()), ISCHANGED(Type), NOT(ISPICKVAL(Type, &quot;Escalation&quot;)), NOT(ISBLANK(Case_Escalated_To_Value__c)))</errorConditionFormula>
        <errorMessage>Click Cancel then Click Take Ownership of the Task before making edits</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>Escalation_Validation</fullName>
        <active>true</active>
        <description>Escalate To is required when Type is Escalation</description>
        <errorConditionFormula>AND ( ISPICKVAL(Type, &quot;Escalation&quot;),  ISPICKVAL (Escalate_To__c, &quot;&quot;) )</errorConditionFormula>
        <errorDisplayField>Escalate_To__c</errorDisplayField>
        <errorMessage>Escalate To is required for Escalation Type Task</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>Sales_Support_Activity_Required_Time</fullName>
        <active>true</active>
        <description>When Sales Support Activity entered the time is required</description>
        <errorConditionFormula>AND( ISBLANK( Sales_Support_Activity_Time__c ),  NOT( ISBLANK( TEXT(  Sales_Support_Activity_Type__c  ) ) )  )</errorConditionFormula>
        <errorDisplayField>Sales_Support_Activity_Time__c</errorDisplayField>
        <errorMessage>Sales Support Activity Time is required when selecting Sales Support Activity Type</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>Sales_Support_Time_Required_Activity</fullName>
        <active>true</active>
        <description>When Sales Support Time entered the Sales Activity Support Type is required</description>
        <errorConditionFormula>AND( NOT(ISBLANK( Sales_Support_Activity_Time__c )),   ISBLANK( TEXT(  Sales_Support_Activity_Type__c  )  )  )</errorConditionFormula>
        <errorDisplayField>Sales_Support_Activity_Type__c</errorDisplayField>
        <errorMessage>Sales Support Activity Type is required if entering Sales Support Activity Time</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>Task_Call_Outcome_Required</fullName>
        <active>true</active>
        <description>Outcome of the call is required when closing(completed/sent) the task</description>
        <errorConditionFormula>AND(
      OR(
          ISPICKVAL(Status, &apos;Completed&apos;) ,
          ISPICKVAL(Status, &apos;Sent&apos;)
       ),
      ISPICKVAL(Type, &apos;Call - Outbound&apos;),
      ISBLANK(TEXT(Call_Outbound_Outcomes__c )),
$Profile.Name &lt;&gt; &quot;System Administrator&quot;, 
$Profile.Name &lt;&gt; &quot;MW Data Administratort&quot;,
$Profile.Name &lt;&gt; &quot;MW RAC Standard User&quot;, 
$Profile.Name &lt;&gt; &quot;MW Customer Service Standard User&quot;
)</errorConditionFormula>
        <errorDisplayField>Call_Outbound_Outcomes__c</errorDisplayField>
        <errorMessage>Outcome of the call is required when closing(completed/sent) the task</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>Task_Email_Outcome_Required</fullName>
        <active>false</active>
        <description>Outcome of the email is required when closing(completed/sent) the task</description>
        <errorConditionFormula>AND(
     OR(
         ISPICKVAL(Status, &apos;Completed&apos;),
         ISPICKVAL(Status, &apos;Sent&apos;)
     ),
     ISPICKVAL(Type, &apos;Email&apos;),
     ISBLANK(TEXT(Email_Outbound_Outcomes__c ))
)</errorConditionFormula>
        <errorDisplayField>Email_Outbound_Outcomes__c</errorDisplayField>
        <errorMessage>Outcome of the email is required when closing(completed/sent) the task</errorMessage>
    </validationRules>
    <webLinks>
        <fullName>Mass_update_tasks</fullName>
        <availability>online</availability>
        <displayType>massActionButton</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Mass Update Tasks</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <requireRowSelection>true</requireRowSelection>
        <url>{!REQUIRESCRIPT(&quot;/soap/ajax/20.0/connection.js&quot;)}
{!REQUIRESCRIPT(&quot;/support/console/30.0/integration.js&quot;)}
var records =  {!GETRECORDIDS( $ObjectType.Task)};
var returnURL = window.location.href;


if(records != null &amp;&amp; records != &apos;&apos;){
if (sforce.console.isInConsole()) {
returnURL = &apos;apex/Activity_mass_update_confirmation&apos;;
var consoleURL = &apos;/apex/activities__UpdateTasks?Ids=&apos;+records+&apos;&amp;retURL=&apos;+returnURL;
sforce.console.openPrimaryTab(null,consoleURL , true, &apos;Mass Update Tasks&apos;, null, &apos;MassUpdateTasksTab&apos;);

} 
else
{
window.open(&apos;/apex/activities__UpdateTasks?Ids=&apos;+records+&apos;&amp;retURL=&apos;+returnURL , &apos;_top&apos;,                                            &apos;height=400,width=600,status=yes,toolbar=yes,menubar=yes,location=no,center=yes,resizable=no&apos;);
}

}else{
    alert(&apos;Please select atleast one task.&apos;);
}</url>
    </webLinks>
    <webLinks>
        <fullName>Take_Ownership</fullName>
        <availability>online</availability>
        <displayType>button</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Take Ownership</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <url>{!REQUIRESCRIPT(&quot;/soap/ajax/10.0/connection.js&quot;)}
{!REQUIRESCRIPT(&quot;/soap/ajax/10.0/apex.js&quot;)}



sforce.apex.execute(&quot;CustomButtonFunctions&quot;,&quot;TakeOwnership&quot;,
	{caseId:&quot;{!Task.Id}&quot;,
	userId:&quot;{!User.Id}&quot;});
	location.reload();

/*if({!Case.IsEscalated}==true){
	location.reload();
}else{
	alert(&apos;Cannot take ownership&apos;);
}*/</url>
    </webLinks>
    <webLinks>
        <fullName>activities__CloseTasks</fullName>
        <availability>online</availability>
        <displayType>massActionButton</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Close Tasks</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <requireRowSelection>true</requireRowSelection>
        <url>{!REQUIRESCRIPT(&quot;/soap/ajax/38.0/connection.js&quot;)}
{!REQUIRESCRIPT(&quot;/soap/ajax/38.0/apex.js&quot;)}
var left = (screen.width/2)-(320/2);
var top = (screen.height/2)-(200/2);
var records = {!GETRECORDIDS($ObjectType.Task)};
var strIDs=&apos;&apos;;
if (records[0] == null)
{
alert(&apos;Please select atleast one record&apos;);
}
else
{
for (var n=0; n&lt;records.length; n++)
{
if(strIDs == &apos;&apos;)
strIDs = records[n];
else
strIDs = strIDs + &quot;,&quot; + records[n];
}
window.location.href = &apos;/apex/activities__CloseTasks?strIDs=&apos;+strIDs+&apos;&amp;retURL=&apos;+ window.location.href;
}</url>
    </webLinks>
    <webLinks>
        <fullName>activities__Mass_Update</fullName>
        <availability>online</availability>
        <displayType>massActionButton</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Mass Update Tasks</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <requireRowSelection>true</requireRowSelection>
        <url>{!REQUIRESCRIPT(&quot;/soap/ajax/38.0/connection.js&quot;)}
var records =  {!GETRECORDIDS( $ObjectType.Task)};
var returnURL = window.location.href;
if(records != null &amp;&amp; records != &apos;&apos;){
     mywin = window.open(&apos;/apex/activities__UpdateTasks?Ids=&apos;+records+&apos;&amp;retURL=&apos;+returnURL , &apos;_top&apos;,
                                             &apos;height=400,width=600,status=yes,toolbar=no,menubar=no,location=no,center=yes,resizable=no&apos;);
     mywin.focus();
}else{
    alert(&apos;Please select atleast one task.&apos;);
}</url>
    </webLinks>
</CustomObject>
